# Animation pour analyse du
# premier prélude du CBT 1
# Mesures 26 - 35

# --- Valeurs par défault ---
DEFAULT('screensize', 610)
DEFAULT('decompte', 0)
DEFAULT('next', 75.5)
DEFAULT('harmony', 34)
DEFAULT('staff_top', 120)
DEFAULT('offset_modulation_y', 15)
DEFAULT('chord', 35)
DEFAULT('staff_harmony', 2)
DEFAULT('caption_timer', true)


# --- La partition dans la longueur
extrait=IMAGE({url:'asset/img/CBT1_Prelude_01/Partition/longueur-20-35.png', x:220, y:370, width:3884, height:161, inner_x:1691, inner_y:15, cadre_width:303, cadre_height:136, hidden:true})

# --- Les portées ---
NEW_STAFF(SOL)
NEW_STAFF(FA)
ACTIVE_STAFF(1)

# ---------------------------------------------------
# Je remets les dernières mesures précédentes

CAPTION("Je remets les deux dernières mesures que nous venons de voir.")
STAFF(1).measure('24')
acc = CHORD('2:g2 2:f3 g3 b3 d4')
acc.chord('G7')
acc.harmony('V7')

NEXT()
STAFF(1).measure('25')
docad = CHORD('2:g2 2:e3 g3 c4 e4')
docad.chord('C')
docad.cadence('I**', {type:parfaite, width:100})

WAIT_CAPTION

# --- Mesure 26 : Gsus7 ---

extrait.show()
CAPTION("Étudions maintenant l'accord de la mesure suivante, la mesure 26.", {wait:true})
CAPTION("Comme pour les autres accords, nous le mettons dans son état de repos, de tierces superposées.")
NEXT()
STAFF(1).measure('26')
SET_CURSOR(260)
acc = CHORD('2:g2 2:d3 g3 c4 f4')
WAIT(2)
acc.note(3).hide()
STAFF(1).remove_suplines({bottom:2})
acc.note(5).move('2:f3')
WAIT_CAPTION

CAPTION("Aïe… Où vais-je donc placer le DO ? La note qui nous manque, entre les autres notes rangées, et qui finaliserait bien l'accord, c'est un SI.", {wait:true})
missingsi = NOTE('2:b2', {color:red})
CAPTION("Placer le DO sous le SOL ?…")
ledo = objet('acc.note(4)')
ledo.move('2:c2')
STAFF(1).remove_suplines({bottom:1})
WAIT_CAPTION

CAPTION("Ça nous ferait une autre note manquante le MI…", {wait:true})
missingmi = NOTE('2:e2', {color:red})
CAPTION(" Possible d'avoir une note manquante, c'est fréquent, mais là, deux… Et un accord DO MI SOL SI RE FA… 6 notes… Ça me semble bien compliqué…", {wait:true})

CAPTION("Rappelez-vous un point capital de l'analyse : l'analyse n'est pas là pour montrer à quel point c'est compliqué. Non, une bonne analyse est là pour montrer au contraire à quel point c'est simple.", {wait:true})

CAPTION("Je dirais qu'il faut toujours chercher la simplexité, dans l'analyse. Des choses simples, mais qui vont produire de la complexité. Dès que vous arrivez à des raisonnements compliqués, dites-vous que vous êtes en train de faire fausse route.", {wait:true})

CAPTION("Je le souligne parce qu'on peut parfois se penser très intelligent à trouver dans les partitions des choses très compliquées. En réalité, la musique est simple. C'est sa force et ce qui la rend accessible à tout le monde, passées certaines barrières culturelles.", {wait:true})

CAPTION("Elle est simple, mais parvient à produire à partir de cette simplicité de la complexité, ce qui fait sa force, sa densité, sa grandeur.", {wait:true})

missingmi.remove({duree:2, wait:false})

CAPTION("Alors peut-être dois-je placer ce DO tout au-dessus ?…")
ledo.move('2:c4')
STAFF(2).remove_suplines({bottom:[1,2]})
WAIT_CAPTION

CAPTION("Ça me parait bien loin du SOL de basse, quand même… Et il manquerait à nouveau deux notes, le SI et le LA, pour former à nouveau un accord de 6 notes différentes…", {wait:true})
missingla = NOTE('2:a3', {color:red})

CAPTION("Je n'ai pas trouvé la simplicité de ce qui se passe ici.", {wait:true})
CAPTION("Réfléchissons autrement… Et commençons pas supprimer ce DO pour y voir plus clair.")
ledo.move('1:c4').fantomize()
missingla.remove({duree:2, wait:false})

WAIT_CAPTION

CAPTION("En fait, cet accord serait parfait si nous avions ce SI manquant…", {wait:true})
CAPTION("SOL SI RÉ FA, ça nous ferait un accord de SOL en 7e de dominante… Justement l'accord de dominante de la tonalité de la pièce…", {wait:true})

CAPTION("De plus, il se trouve justement que le SI manquant se trouve seulement à un demi-ton du DO que nous cherchons à placer, à comprendre…", {wait:true})

CAPTION("Et si, donc… ce DO remplaçait simplement ce SI manquant ? Et si c'était ce qu'on appelle un retard ? C'est-à-dire une note de l'accord précédent qui perdure sur l'accord suivant, avant de rejoindre la note correcte de cet accord suivant ?", {wait:true})

CAPTION("Nous avons effectivement ce DO dans l'accord précédent.", {wait:true})
docad.note(4).exergue({color:green})
boxretard = BOX({type:cadre, x:166, y:170, width:116, height:20, color:blue, opacity:0.5})

CAPTION("Jetons un coup d'œil à l'accord qui vient ensuite.", {wait:true})
extrait.travelling({x:1919})
boxretard.remove({duree:4, wait:false})

NEXT()
STAFF(1).measure('27')
accsol = CHORD('2:g2 2:d3 g3 b4 f4')
accsol.note(5).move('2:f3')
accsol.note(3).hide()
accsol.note(4).move('2:b2')

CAPTION("Bingo ! Nous avons dans la mesure suivante le même accord, mais cette fois avec notre SI, la tierce, la note manquante.", {wait:true})

CAPTION("Un parfait accord de Dominante, 5e degré de notre tonalité principale.")
accsol.chord('G7')
accsol.harmony('V7')
WAIT_CAPTION

extrait.travelling({x:1690})
docad.note(4).unexergue({wait:false})
missingsi.remove({duree:2, wait:false})

CAPTION("Donc, notre note DO est bien ce que nous pensions : un retard, une note héritée de l'accord précédent, et qui ne rejoindra la note véritable de l'accord courant que dans la mesure suivante.", {wait:true})

ledo.defantomize().move('c3')
STAFF(2).remove_suplines({top:1, y:260})

CAPTION("Cet accord, lorsque l'on a fait un peu d'analyse, on le connait très bien, c'est un accord utilisé à outrance en musique, dans toute forme de musique. Il a un effet très sensible, très prenant.", {wait:true})

CAPTION("C'est le retard de la tierce de l'accord de dominante. Ici le retard de la tierce de SOL 7e, SI.", {wait:true})

CAPTION("Analysé verticalement, c'est un accord où la tierce de l'accord — ici le SI — est remplacé provisoirement par la quarte de l'accord — ici le DO. On appelle cet accord un accord « SUS 4 ».")
ledo.move('2:c3')
WAIT_CAPTION

CAPTION("On peut le désigner seulement SUS puisque implicitement il s'agit par défaut de la tierce et la quarte.")

acc.chord('Gsus7')
acc.harmony('Vsus7')
WAIT_CAPTION
acc.note(3).show()
acc.note(5).move('1:f4')


# --- Mesure 27 : G7 ---
# (note : déjà analysé avant)

CAPTION("Nous avons déjà analysé l'accord de la mesure 27 qui suit.")
extrait.travelling({x:1919})
accsol.note(3).show()
accsol.note(4).move('1:b4')
accsol.note(5).move('2:f4')
WAIT_CAPTION

CAPTION("Notez quand même que c'est la première fois que nous avons un même accord qui s'étale sur deux mesures. Et comme par hasard, l'accord de dominante, celui qui prépare le mieux l'accord de tonique…", {wait:true})

CAPTION("Je vous le dis, ça sent le souffre… La fin est proche…", {wait:true})


# --- Mesure 28 : F#7dim/sol ---

CAPTION("Voyons notre mesure 28…")
NEXT()
extrait.travelling({x:})
STAFF(1).measure('28')
acc = CHORD('2:g2 2:eb3 a3 c4 fd4')
WAIT_CAPTION

CAPTION("Pas facile… C'est la première fois que nous rencontrons 5 notes différentes pour constituer un accord.", {wait:true})

# ---------------------------------------------------
# J'EN SUIS LÀ
# ---------------------------------------------------

acc.note(2).fantomize()
prov = NOTE('eb4')
WAIT(1)
acc.chord('F#7dim/sol')
WAIT(1)
acc.modulation('G[V de C]')
WAIT(1)
acc.harmony('VII7dim')

# --- Mesure 29 : C** ---
NEXT()
acc = CHORD('2:g2 2:ez3 g3 c4 g4')
WAIT(1)
acc.chord('C')
acc.harmony('I**')


# --- Mesure 30 : Gsus7 ---

NEXT()
STAFF(1).write("(répétion de mesures 26, 27)")
acc = CHORD('2:g2 2:d3 g3 c4 f4')
WAIT(2)
acc.chord('Gsus7')
acc.harmony('Vsus7')
WAIT(1)

# --- Mesure 31 : G7 ---

NEXT()
acc = CHORD('2:g2 2:d3 g3 b4 f4')
WAIT(1)
acc.chord('G7')
acc.harmony('V7')

# --- Mesure 32 : C ---

NEXT()
STAFF(1).write("1ère fois octave de do + si bas (+ possibilité de s'arrêter un peu sur Do pour marquer la cadence)")
acc = CHORD('2:c2 2:c3 g3 bb3 e4')
WAIT(4)
acc.chord('C[C7]')
acc.cadence('I', {type:parfaite, width:200})
acc.modulation('Fa[IV]', {offset_x:30})
STAFF(1).write("Modulation au IVe degré typique de coda (cf. aussi développement)")

# --- Mesure 33 : F / Dm7 ---
NEXT()
acc = CHORD('2:c2 2:c3 2:f3 2:a3 c4 f4')
WAIT(1)
acc.note([1,2,6]).fantomize()
WAIT(1)
acc.chord('F')
WAIT(1)
acc.harmony('IV')
WAIT(1)
acc.note([1,2,6]).defantomize()

NEXT()
acc = CHORD('2:c2 2:c3 2:d3 2:f3 2:a3 c4')
WAIT(1)
acc.note([1,2]).fantomize()
WAIT(1)
acc.chord('Dm7/do')
WAIT(1)
acc.harmony('II7***')
acc.note([1,2]).defantomize()

# --- Mesure 34 : G7 ---
NEXT()
acc = CHORD('2:c2 2:b2 g4 b4 d5 f5')
WAIT(1)
acc.note([1,2]).fantomize()
WAIT(1)
acc.chord('G7')
WAIT(1)
acc.harmony('V7/do')
WAIT(1)

# --- Mesure 35 : C ---
NEXT()
acc = CHORD('2:c2 2:c3 e4 g4 c5')
WAIT(1)
acc.chord('C')
WAIT(1)
acc.cadence('C', {type:parfaite, width:200})


