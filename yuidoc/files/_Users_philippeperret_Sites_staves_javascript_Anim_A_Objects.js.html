<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>/Users/philippeperret/Sites/staves/javascript/Anim/A_Objects.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Anim.html">Anim</a></li>
            
                <li><a href="../classes/Anim.Cursor.html">Anim.Cursor</a></li>
            
                <li><a href="../classes/Anim.Dom.html">Anim.Dom</a></li>
            
                <li><a href="../classes/Anim.File.html">Anim.File</a></li>
            
                <li><a href="../classes/Anim.Grid.html">Anim.Grid</a></li>
            
                <li><a href="../classes/Anim.Objects.html">Anim.Objects</a></li>
            
                <li><a href="../classes/Anim.options.html">Anim.options</a></li>
            
                <li><a href="../classes/Arrow.html">Arrow</a></li>
            
                <li><a href="../classes/Box.html">Box</a></li>
            
                <li><a href="../classes/Chord.html">Chord</a></li>
            
                <li><a href="../classes/Circle.html">Circle</a></li>
            
                <li><a href="../classes/COLOR_TEXT_PER_BACKGROUND.html">COLOR_TEXT_PER_BACKGROUND</a></li>
            
                <li><a href="../classes/Console.html">Console</a></li>
            
                <li><a href="../classes/Courbe.html">Courbe</a></li>
            
                <li><a href="../classes/DATA_AUTOCOMPLETION.html">DATA_AUTOCOMPLETION</a></li>
            
                <li><a href="../classes/DATA_SCREEN.html">DATA_SCREEN</a></li>
            
                <li><a href="../classes/Debug.html">Debug</a></li>
            
                <li><a href="../classes/Doublage.html">Doublage</a></li>
            
                <li><a href="../classes/ImageTool.html">ImageTool</a></li>
            
                <li><a href="../classes/Img.html">Img</a></li>
            
                <li><a href="../classes/Infos.html">Infos</a></li>
            
                <li><a href="../classes/Motif.html">Motif</a></li>
            
                <li><a href="../classes/Note.html">Note</a></li>
            
                <li><a href="../classes/OBJET_TRAITEMENT.html">OBJET_TRAITEMENT</a></li>
            
                <li><a href="../classes/ObjetClass.html">ObjetClass</a></li>
            
                <li><a href="../classes/Pas.html">Pas</a></li>
            
                <li><a href="../classes/REGEXP_NOTE.html">REGEXP_NOTE</a></li>
            
                <li><a href="../classes/Regle.html">Regle</a></li>
            
                <li><a href="../classes/Scale.html">Scale</a></li>
            
                <li><a href="../classes/Staff.html">Staff</a></li>
            
                <li><a href="../classes/Step.html">Step</a></li>
            
                <li><a href="../classes/STYLE_TO_PROPS.html">STYLE_TO_PROPS</a></li>
            
                <li><a href="../classes/TBox.html">TBox</a></li>
            
                <li><a href="../classes/tools.html">tools</a></li>
            
                <li><a href="../classes/Txt.html">Txt</a></li>
            
                <li><a href="../classes/UI.html">UI</a></li>
            
                <li><a href="../classes/UI.Popups.html">UI.Popups</a></li>
            
                <li><a href="../classes/UI.Popups.Methods.html">UI.Popups.Methods</a></li>
            
                <li><a href="../classes/UI.Tools.html">UI.Tools</a></li>
            
                <li><a href="../classes/UNVERSAL_BOX_METHODS.html">UNVERSAL_BOX_METHODS</a></li>
            
                <li><a href="../classes/UNVERSAL_METHODS.html">UNVERSAL_METHODS</a></li>
            
                <li><a href="../classes/window.html">window</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Anim.html">Anim</a></li>
            
                <li><a href="../modules/Anim_Cursor
Gestion du curseur de position de l&#x27;animation.html">Anim_Cursor
Gestion du curseur de position de l&#x27;animation</a></li>
            
                <li><a href="../modules/Anim_Dom.js.html">Anim_Dom.js</a></li>
            
                <li><a href="../modules/Anim_File.html">Anim_File</a></li>
            
                <li><a href="../modules/Anim_Grid.html">Anim_Grid</a></li>
            
                <li><a href="../modules/Anim_infos.html">Anim_infos</a></li>
            
                <li><a href="../modules/Anim_Objects.js.html">Anim_Objects.js</a></li>
            
                <li><a href="../modules/Anim_Step.html">Anim_Step</a></li>
            
                <li><a href="../modules/Arrow.js.html">Arrow.js</a></li>
            
                <li><a href="../modules/Box.js.html">Box.js</a></li>
            
                <li><a href="../modules/Chord.js.html">Chord.js</a></li>
            
                <li><a href="../modules/Circle.js.html">Circle.js</a></li>
            
                <li><a href="../modules/Console.js.html">Console.js</a></li>
            
                <li><a href="../modules/constantes.html">constantes</a></li>
            
                <li><a href="../modules/contantes_autocompletion.js.html">contantes_autocompletion.js</a></li>
            
                <li><a href="../modules/Controller.js.html">Controller.js</a></li>
            
                <li><a href="../modules/Courbe.js.html">Courbe.js</a></li>
            
                <li><a href="../modules/Debug

Pour le débuggage en temps réel

Chaque fonction devrait commencer par :
  stack(&quot;-&gt; &lt;nom string de la fonction&gt;&quot;[, &lt;paramètres éventuels&gt;])

Pour obtenir le stack (l&#x27;afficher en console) :
  Debug.output().html">Debug

Pour le débuggage en temps réel

Chaque fonction devrait commencer par :
  stack(&quot;-&gt; &lt;nom string de la fonction&gt;&quot;[, &lt;paramètres éventuels&gt;])

Pour obtenir le stack (l&#x27;afficher en console) :
  Debug.output()</a></li>
            
                <li><a href="../modules/Dom_Doublage.js.html">Dom_Doublage.js</a></li>
            
                <li><a href="../modules/Event.js
Gestion des évènements.html">Event.js
Gestion des évènements</a></li>
            
                <li><a href="../modules/Functions.js.html">Functions.js</a></li>
            
                <li><a href="../modules/GroupNotes.js.html">GroupNotes.js</a></li>
            
                <li><a href="../modules/handy.js.html">handy.js</a></li>
            
                <li><a href="../modules/Image.js.html">Image.js</a></li>
            
                <li><a href="../modules/ImageTool.js.html">ImageTool.js</a></li>
            
                <li><a href="../modules/Motif.js.html">Motif.js</a></li>
            
                <li><a href="../modules/Note.html">Note</a></li>
            
                <li><a href="../modules/Pas.js.html">Pas.js</a></li>
            
                <li><a href="../modules/Scale.js.html">Scale.js</a></li>
            
                <li><a href="../modules/Staff.html">Staff</a></li>
            
                <li><a href="../modules/TBox.js.html">TBox.js</a></li>
            
                <li><a href="../modules/Texte.js.html">Texte.js</a></li>
            
                <li><a href="../modules/Txt.js.html">Txt.js</a></li>
            
                <li><a href="../modules/UI.js.html">UI.js</a></li>
            
                <li><a href="../modules/UI.Popups.html">UI.Popups</a></li>
            
                <li><a href="../modules/UI.Regle.js.html">UI.Regle.js</a></li>
            
                <li><a href="../modules/UI.Tools.js.html">UI.Tools.js</a></li>
            
                <li><a href="../modules/UniversalBoxMethods.js.html">UniversalBoxMethods.js</a></li>
            
                <li><a href="../modules/UniversalMethods.html">UniversalMethods</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: /Users/philippeperret/Sites/staves/javascript/Anim/A_Objects.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
  * @module Anim_Objects.js
  */

/**
  * Méthode pratique pour récupérer un objet de l&#x27;animation
  *
  * @method objet
  * @for    window
  * @param  {String} refobjet   La référence de l&#x27;objet
  */
window.objet = function(refobjet)
{
  return eval(&#x27;Anim.Objects.&#x27;+refobjet)
}

if(undefined == window.Anim) window.Anim = {}
/**
  * Les objets qui vont être créés par les lignes de code de l&#x27;animation,
  * mais également toutes les fonctions qu&#x27;on peut trouver dans les pas.
  * pour que l&#x27;évaluation du code soit très simple (&#x60;this.Objects.&lt;code&gt;&#x60;)
  *
  * @class Anim.Objects
  * @static
  */

Anim.Objects = {}

FONCTIONS_ANIM_OBJETS = {
  /**
    * Retourne la portée d&#x27;indice +indice+ (1-start)
    * @method STAFF
    */
  STAFF:function(istaff){
    // dlog(&quot;-&gt; Anim.Objects.STAFF&quot;)
    return Anim.staves[istaff - 1]
  },
  /**
    * Commande pour construire une gamme sans la placer dans une variable
    * Cf. la fonction SCALE.
    * @method SCALE
    */
  SCALE:function(scale, params){return SCALE(scale, params)},
  /** Commande pour construire une note sans la placer dans une variable
    * cf. la fonction NOTE
    * @method NOTE
    */
  NOTE:function(note, params){return NOTE(note, params)},
  /**
    * Command pour construire un motif sans le placer dans une variable
    * cf. la fonction MOTIF
    * @method MOTIF
    */
  MOTIF:function(notes, params){return MOTIF(notes, params)},
  /** Commande pour construire un accord sans le placer dans une variable
    * cf. la fonction CHORD
    * @method CHORD
    */
  /**
    * Commande pour construire une boite (non texte)
    * cf. la fonction BOX
    * @method BOX
    */
  BOX:function(params){return BOX(params)},
  /**
    * Commande pour construire une boite de background
    * cf. la fonction BACKGROUND
    * @method BACKGROUND
    */
  BACKGROUND:function(color, params){return BACKGROUND(color, params)},
  
  /** Commande pour construire une boite de texte
    * cf. la fonction TBOX
    * @method TBOX
    */
  TBOX:function(texte, params){return TBOX(texte, params)},
  
  /** Commande pour écrire un sous-titre à l&#x27;écran (doublage ou sous-titre)
    * Note : les doublages et sous-titres ne sont pas des textes comme les
    * autre, ils se mettent simplement dans des DIV qui leur sont réservés
    * @method CAPTION
    */
  CAPTION:function(texte, params){Anim.Dom.Doublage.show(texte, params)},

  CHORD:function(notes, params){return CHORD(notes, params)},
  /** Commande pour construire une flèche sans la placer dans une variable
    * cf. la fonction ARROW
    * @method ARROW
    */
  ARROW:function(params){return ARROW(params)},
  /** Commande pour créer une image sans la placer dans une variable
    * cf. la fonction IMAGE
    * @method IMAGE
    */
  IMAGE:function(params){return IMAGE(params)},
  
  /**
    * Méthode pour attendre +laps+ secondes avant de poursuivre
    * l&#x27;animation
    * @method WAIT
    * @param  {Number} laps   Nombre de secondes
    * @example
    *   // Dans le code de l&#x27;animation
    *   WAIT(4)
    */
  WAIT:function(laps)
  {
    if(MODE_FLASH) return Anim.Step.auto_next()
    else Anim.Step.auto_next( laps * Anim.delai_for(&#x27;wait&#x27;) )
  },
  WRITE:function(texte)
  {
    F.show(texte) // pour le moment
  },
  /**
    * Affiche une nouvelle portée et la met en portée courante
    * @method NEW_STAFF
    * @param {String|Constante} cle   La clé de la portée
    * @param {Object} params  Paramètres optionnels (donc wait et durée)
    *                         Cf. la méthode Staff.create
    * @return {Staff} La nouvelle portée
    */
  NEW_STAFF:function(cle, params)
  {
    params = define_wait_and_duree(params, {}, &#x27;show&#x27;)
    Anim.current_staff = Staff.create(cle, params)
    traite_wait( params )
    return Anim.current_staff
  },
  
  /**
    * Déplace le &quot;curseur de position&quot; horizontalement pour définir le décalage 
    * horizontal de la nouvelle inscription.
    * Notes
    *   * Redéfinit la valeur de Anim.current_x
    *   * Passe à l&#x27;étape suivante
    * @method NEXT
    * @param  {Number|Object} param  Cf. la méthode &#x60;Anim.Cursor.next()&#x60;   
    */
  NEXT:function(param){Anim.Cursor.next(param)},
  /**
    * Place le curseur à une position précise
    * Notes
    *   * Redéfinit la valeur de Anim.current_x
    * @method SET_CURSOR
    * @param {Number|Object} param Définition de la nouvelle position. Cf. &#x60;Anim.Cursor.set_cursor&#x60;
    */
  SET_CURSOR:function(param, value){Anim.Cursor.set_cursor(param,value)},
  /**
    * Activer la portée +indice+ (1-start)
    * @method ACTIVE_STAFF
    * @param {Number} indice Numéro de la portée dans l&#x27;affichage, 1-start
    */
  ACTIVE_STAFF:function(indice)
  {
    Anim.current_staff = Anim.staves[indice-1]
    NEXT_STEP(0)
  },
  
  /**
    * Suppression des lignes supplémentaires
    * @method REMOVE_SUPLINE
    * @param  {Object}  params  Les paramètres pour supprimer
    *   @param  {Number}  params.staff    L&#x27;indice-portée de la portée dont il faut supprimer des lignes
    *                                     Par défaut, c&#x27;est la portée active.
    *   @param  {Number|Array}  params.bottom   La ou les lignes à supprimer en bas
    *   @param  {Number|Array}  params.top      La ou les lignes à supprimer en haut
    *   @param  {Number}        params.xoffset  Position horiztonale de la ligne (Anim.current_x par défaut)
    */
  REMOVE_SUPLINE:function(params)
  {
    if(undefined == params) return F.error(&quot;Il faut donner les paramètres pour la suppression des lignes supplémentaires !&quot;)
    if(undefined == params.staff)   params.staff = Anim.current_staff.indice
    if(undefined == params.xoffset) params.xoffset = Anim.current_x
    if(params.bottom)
    {
      if(&#x27;number&#x27; == typeof params.bottom) params.bottom = [params.bottom]
      Staff.erase_suplines(params.staff, params.xoffset, &#x27;bot&#x27;, params.bottom)
    }
    if(params.top)
    {
      if(&#x27;number&#x27; == typeof params.top) params.top = [params.top]
      Staff.erase_suplines(params.staff, params.xoffset, &#x27;top&#x27;, params.top)
    }
    NEXT_STEP(0)
  },
  /**
    * Nettoie l&#x27;animation. Si &#x60;with_staves&#x60; est true, on efface aussi les
    * portée
    * Notes
    * -----
    *   * Si la suppression des portées est demandée, elles disparaitront vraiment,
    *     ie seront retirées de Anim.staves
    *
    * @method CLEAN
    */
  CLEAR:function(with_staves){Anim.Dom.clear(NEXT_STEP, {staves:with_staves})},
  
  /**
    * Modifie la vitesse de l&#x27;animation
    * @method SPEED
    * @param {Number} indice_vitesse Une valeur de 0 à 20
    */
  SPEED:function(indice_vitesse)
  {
    if(undefined == indice_vitesse) indice_vitesse = 10
    if(isNaN(indice_vitesse)) throw &quot;Il faut donner un nombre pour la vitesse ! (SPEED)&quot;
    if(indice_vitesse &lt; 0 || indice_vitesse &gt; 20) throw &quot;L&#x27;indice vitesse est invalide (SPEED(0&amp;lt;-&gt;21))&quot;
    Anim.set_speed(indice_vitesse + 1)
    NEXT_STEP(0)
  },
    
  /* ---------------------------------------------------------------------
   *    PRÉFÉRENCES
   */
  /**
    * Pour définir les valeurs par défaut
    * Notes
    * -----
    *   * Il y a deux types de préférences : les préférences absolues et les
    *     préférences relatives. Les relatives se reconnaissent au fait que leur
    *     nom commence toujours par &quot;offset_&quot;.
    *   * Lorsqu&#x27;une valeur absolue est définie, la même valeur offset est toujours
    *     (re)mise à 0 pour obtenir vraiment la valeur recherchée.
    *
    * @method DEFAULT
    * @param  {Object|String} clevalue   Valeurs par défaut à régler, avec en
    *                             clé le nom de préférence et en valeur la valeur
    *                             à lui donner.
    *                             OU la clé seule (+value+ doit être défini)
    * @param  {Number}  value   Si +clevalue+ est un string (propriété), il faut définir la valeur à lui donner.
    *                           Si value n&#x27;est pas définie, ça sera la valeur par défaut.
    */
  DEFAULT:function(clevalue, value)
  {
    if(&#x27;string&#x27; == typeof clevalue)
    {
      Anim.set_pref(clevalue, value, next_step=false)
    }
    else
    {
      L(clevalue).each(function(k,v){
        Anim.set_pref(k, v, next_step=false)
      })
    }
    NEXT_STEP(0)
  },
  /**
    * Décalage des marques d&#x27;harmonie par rapport à la portée
    * @method OFFSET_HARMONIE
    * @param {Number} offset    Décalage par rapport à la valeur courante
    *
    */
  OFFSET_HARMONY:function(offset)
  {
    Anim.set_pref(&#x27;offset_harmony&#x27;, offset)
  },
  /**
    * Décalage des marques d&#x27;accords par rapport à la portée
    * Noter que la valeur sera retirée, pour qu&#x27;une valeur positive éloigne de
    * la portée
    * @method OFFSET_CHORD_MARK
    * @param {Number} offset    Décalage par rapport à la valeur courante
    *
    */
  OFFSET_CHORD_MARK:function(offset)
  {
    Anim.set_pref(&#x27;offset_chord&#x27;, offset)
  },
  
  /**
    * Commande qui charge pour suivre l&#x27;animation donnée en argument. Les deux
    * animation s&#x27;enchaineront.
    * Note : La commande peut être placée n&#x27;importe où puisqu&#x27;elle n&#x27;exécutée qu&#x27;à
    * la toute fin de l&#x27;animation.
    * @method LOAD_ANIM
    * @param {String} path    Chemin à l&#x27;animation à charger. Le nom de l&#x27;animation si elle se trouve dans le même dossier.
    * @param {Object} params  Paramètres optionnels
    */
  SUITE:function(path, params)
  {
    Anim.set_animation_pour_suivre(path, params)
  },
  
  /** Exécute simplement le code fourni et passe tout de suite à l&#x27;étape suivante
    * @method EXEC
    */
  EXEC:function(code)
  {
    eval(code)
    NEXT_STEP(0)
  }
}

METHODES_ANIM_OBJETS = {
  /**
    * Pseudo-méthode pour passer en mode flash
    * @method MODE_FLASH
    */
  &quot;MODE_FLASH&quot;:{
    get:function(){ MODE_FLASH = true; NEXT_STEP(0)}
  },
  // Alias
  &quot;FLASH&quot;:{get:function(){this.MODE_FLASH}},
  /**
    * Pseudo-méthode pour sortir du mode flash
    * @method STOP_MODE_FLASH
    */
  &quot;STOP_MODE_FLASH&quot;:{
    get:function(){ MODE_FLASH = false; NEXT_STEP(0)}
  },
  // Alias
  &quot;STOP_FLASH&quot;:{get:function(){this.STOP_MODE_FLASH}},
  /**
    * Remet le curseur de position à la position de départ (début des portées)
    * @method RESET_CURSOR
    */
  &quot;RESET_CURSOR&quot;:{
    get:function(){
      Anim.current_x = parseInt(Anim.prefs.x_start,10)
      NEXT_STEP(0)
    }
  },
  /**
    * Méthode qui reset l&#x27;affichage
    * Produit
    * -------
    *   * Remet la position left (x) à la position de départ
    *   * Efface tout sauf les portées
    *   * Propriété complexe =&gt; appeler sans parenthèses
    *
    * @method RESET
    */
  &quot;RESET&quot;:{
    get:function(){
      $(&#x27;section#animation &gt; *:not(div.staff)&#x27;).remove()
      this.RESET_CURSOR // c&#x27;est elle qui appellera l&#x27;étape suivante
    }
  },
  &quot;RESET_PREFERENCES&quot;:{
    get:function(){
      Anim.reset_prefs()
      NEXT_STEP(0)
    }
  },
  /**
    * Pseudo-méthode qui permet d&#x27;attendre la fin de l&#x27;écriture d&#x27;un doublage avant
    * de passer à la suite
    * Si le CAPTION contient les paramètres {wait:true}, l&#x27;animation attend la fin
    * de l&#x27;écriture du doublage, mais parfois on veut que pendant l&#x27;écriture du 
    * doublage il se passe quelque chose. C&#x27;est dans ce cas que cette commande entre
    * en action.
    * @method WAIT_CAPTION
    */
  &quot;WAIT_CAPTION&quot;:{
    get:function(){
      if(Anim.prefs.caption_timer == false)
      {
        if(!MODE_FLASH) F.error(&quot;WAIT_CAPTION doit être utilisé dans le contexte de doublage énoncés (&#x60;DEFAULT(&#x27;caption_timer&#x27;, true)&#x60;).\nJe passe à l&#x27;étape suivante sans attendre.&quot;)
        NEXT_STEP(0)
      }
      else
      {
        // Si un doublage est toujours en cours d&#x27;écriture, on ne fait simplement
        // rien du tout. C&#x27;est la fin du doublage qui lancera l&#x27;étape suivante.
        // Mais comme d&#x27;autre processus peuvent appeler auto_next, on met un
        // Anim.waiting_for_caption qui les bloquera.
        // Dans le cas contraire, on lance l&#x27;étape suivante.
        if(Anim.Dom.Doublage.on)
        {
          Anim.waiting_for_caption = true
          Anim.Dom.Doublage.temporize.poursuivre = $.proxy(Anim.Dom.Doublage.end_waiting_for_caption, Anim.Dom.Doublage)
        } 
        else NEXT_STEP(0)
      }
    }
  }
  
}

$.extend(Anim.Objects, FONCTIONS_ANIM_OBJETS)
Object.defineProperties(Anim.Objects, METHODES_ANIM_OBJETS)
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
